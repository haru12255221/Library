# 図書館管理システム - 実装タスクリスト

## 実装タスク

### フェーズ1: 検索機能の実装

- [x] 1. 書籍一覧ページの基本構造を作成
  - resources/views/books/index.blade.php ファイルを作成
  - 既存のcreate.blade.phpと統一されたデザインシステムを使用
  - Tailwind CSSでレスポンシブレイアウトを実装
  - _要件: 3.1, 3.2, 3.3_

- [x] 2. 検索フォームコンポーネントを実装
  - 検索キーワード入力フィールドを作成
  - リアルタイム検索のためのAlpine.jsイベントハンドリング
  - 検索ボタンとクリアボタンを追加
  - _要件: 4.1, 4.5_

- [x] 3. BookControllerの検索機能を実装
  - index メソッドに検索パラメータ処理を追加
  - Book モデルに検索スコープメソッドを実装
  - 検索結果の件数表示機能を追加
  - _要件: 4.1, 4.2, 4.3, 4.4_

- [x] 4. 書籍一覧表示の実装
  - 書籍データのテーブル表示を作成
  - 検索結果がない場合のメッセージ表示
  - 書籍データが存在しない場合のメッセージ表示
  - _要件: 3.2, 3.3, 4.3_

- [ ] 5. 検索機能のテストを作成
  - BookControllerの検索機能の単体テスト
  - 検索スコープの動作テスト
  - 空の検索結果のテスト
  - _要件: 4.1, 4.2, 4.3, 4.4_

### フェーズ2: 管理者権限システムの実装

- [x] 6. AdminMiddlewareを作成
  - app/Http/Middleware/AdminMiddleware.php を作成
  - ユーザーロールチェック機能を実装
  - 権限不足時の403エラーハンドリング
  - _要件: 1.3, 1.4_

- [x] 7. Userモデルにロール判定メソッドを追加
  - isAdmin() メソッドを実装
  - isUser() メソッドを実装
  - ロール定数の定義
  - _要件: 1.3, 1.4_

- [ ] 8. ルート保護の設定
  - web.php で管理者専用ルートにミドルウェアを適用
  - 書籍登録・編集機能を管理者のみに制限
  - 適切なルートグループ化
  - _要件: 1.3, 1.4, 2.1_

- [ ] 9. 権限チェックのテストを作成
  - AdminMiddlewareの動作テスト
  - 管理者・一般ユーザーのアクセステスト
  - 403エラーレスポンステスト
  - _要件: 1.3, 1.4_

### フェーズ3: 書籍登録機能の改善

- [ ] 10. 書籍登録フォームのバリデーション強化
  - BookControllerのstoreメソッドにバリデーションルール追加
  - 日本語エラーメッセージの設定
  - フロントエンドでのリアルタイムバリデーション
  - _要件: 2.3, 2.5_

- [ ] 11. 重複ISBN チェック機能の実装
  - データベースレベルでのユニーク制約確認
  - わかりやすいエラーメッセージ表示
  - 既存書籍との重複時の案内機能
  - _要件: 2.3_

- [ ] 12. 書籍登録成功時のUX改善
  - 成功メッセージの表示機能
  - 書籍一覧ページへの自動リダイレクト
  - 登録した書籍のハイライト表示
  - _要件: 2.4_

### フェーズ4: ISBN自動入力機能の実装

- [ ] 13. 外部API統合の準備
  - Google Books API または OpenBD APIの調査と選択
  - APIキーの環境変数設定
  - HTTP クライアント設定（Guzzle使用）
  - _要件: 5.1_

- [ ] 14. ISBN自動入力のバックエンド実装
  - BookController に fetchByIsbn メソッドを追加
  - 外部APIからの書籍情報取得処理
  - APIエラー時のフォールバック処理
  - _要件: 5.1, 5.2, 5.3_

- [ ] 15. フロントエンドでの自動入力機能
  - Alpine.js を使用したISBN入力時のイベント処理
  - 非同期でのAPI呼び出し実装
  - ローディング状態の表示
  - _要件: 5.1, 5.2_

- [ ] 16. 自動入力機能のエラーハンドリング
  - ネットワークエラー時のメッセージ表示
  - 書籍情報が見つからない場合の処理
  - 手動入力への切り替え案内
  - _要件: 5.3, 5.4_

### フェーズ5: UI/UX改善と拡張機能

- [ ] 17. レスポンシブデザインの実装
  - モバイル・タブレット・デスクトップ対応
  - 書籍一覧のグリッドレイアウト調整
  - 検索フォームのモバイル最適化
  - _技術制約: レスポンシブデザイン対応_

- [ ] 18. 書籍詳細表示機能の実装
  - BookController に show メソッドを追加
  - resources/views/books/show.blade.php を作成
  - 書籍一覧からの詳細ページリンク
  - _要件: 3.2 の拡張_

- [ ] 19. 書籍カバー画像機能の基盤実装
  - books テーブルに cover_image カラムを追加
  - 画像アップロード機能の実装
  - 画像表示とサムネイル生成
  - _設計書: 画像最適化機能_

- [ ] 20. 書籍カバー画像の表示機能
  - 一覧ページでのカバー画像表示
  - 詳細ページでの大きなカバー画像表示
  - デフォルト画像の設定
  - _設計書: 画像最適化機能_

- [ ] 21. パフォーマンス最適化
  - データベースインデックスの追加
  - 検索クエリの最適化
  - Tailwind CSS の本番ビルド設定
  - _設計書: パフォーマンス考慮事項_

### フェーズ6: テストとデプロイ準備

- [ ] 22. 統合テストの実装
  - 書籍登録から検索までの一連のフロー
  - 管理者・一般ユーザーの権限テスト
  - エラーケースの網羅的テスト
  - _設計書: テスト戦略_

- [ ] 23. ブラウザテストの実装
  - 主要ブラウザでの動作確認
  - JavaScript機能のテスト
  - レスポンシブデザインのテスト
  - _設計書: テスト戦略_

- [ ] 24. セキュリティチェックの実装
  - CSRF保護の確認
  - XSS対策の検証
  - SQLインジェクション対策の確認
  - _設計書: セキュリティ考慮事項_

- [ ] 25. 本番環境準備
  - 環境変数の設定
  - データベースマイグレーションの実行
  - 初期データの投入
  - _技術制約: Laravel 11.x, MySQL 8.0_